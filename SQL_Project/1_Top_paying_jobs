/*Question: What are the top-paying data analyst jobs?
-Identify the top 10 highest-paying Data Analyst roles that are available remotely
-Focuses on job_postings with specified salaries (remove nulls).
-WHy? Highlight the top-paying opportunities for Data Analysts, offering insights into employment opportunities

/*Just looking at the dataset for ideas*/ 
SELECT *
FROM job_postings_fact
LIMIT 1000;


/*Looking at data/business Analyst roles that are either entry-level or junior in the U.S.
  -I'll use chatgpt to assign industry names to each company
  -Then I'll graph showcasing the number of jobs each industry offered, and the average salary*/
Select
  job_title,
  job_title_short,
  job_location,
  job_schedule_type,
  job_country,
  salary_year_avg,
  name as company_name
FROM 
  job_postings_fact
LEFT JOIN company_dim ON job_postings_fact.company_id = company_dim.company_id
WHERE 
    (job_title_short = 'Data Analyst'  OR
     job_title_short = 'Business Analyst') 
  and (job_title LIKE '%Entry_Level%' 
    OR job_title LIKE '%junior%')
   AND Salary_year_avg IS NOT NULL 
   AND job_schedule_type = 'Full-time'
    AND job_country = 'United States'
ORDER BY 
  Salary_year_avg DESC
;

--Looking at the top 50 highest paying data/business analyst positions and their corresponding companies.
--Then using Chatgpt to assign industries to each 
--graph by number of jobs for each industry and avg salary for each industry
Select
  job_title,
  job_title_short,
  job_location,
  job_schedule_type,
  job_country,
  salary_year_avg,
  name as company_name
FROM 
  job_postings_fact
LEFT JOIN company_dim ON job_postings_fact.company_id = company_dim.company_id
WHERE 
     (job_title_short = 'Data Analyst' 
    OR job_title_short = 'Business Analyst')
   AND Salary_year_avg IS NOT NULL 
   AND job_schedule_type = 'Full-time'
   AND job_country = 'United States'
ORDER BY 
  Salary_year_avg DESC
  LIMIT 50
;


